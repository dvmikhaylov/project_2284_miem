# Отчет о тестировании пайплайна

## Дата тестирования
Тестирование проведено на Mac M3 Pro 32GB

## Установка и настройка

### Установленные зависимости:
- python-docx, PyPDF2, pdfplumber (чтение документов)
- natasha (NER для русского языка)
- spacy (альтернативный NER)
- pydantic, tqdm (утилиты)

### Конфигурация:
- NER модель: Natasha (по умолчанию)
- GPU: не используется (все модели работают на CPU)
- Виртуальное окружение: создано и активировано

## Результаты тестирования

### Тест 1: Договор.docx (большой документ)
- **Размер**: 87,627 символов
- **Сущностей найдено**: 93 (после фильтрации)
- **Связей найдено**: 190 (после улучшений)
- **Цепочек построено**: 190
- **Бизнес-процесс**: Закупки и административные процессы - Контракты с поставщиками
- **Уверенность**: 0.80

**Примеры извлеченных сущностей:**
- Москва (LOC)
- АО «ВДНХ» (ORG)
- Тимура Эдуардовича (PER)

**Примеры связей:**
- Коммерческого директора --[управлять]--> Управление персоналом
- Google --[заключить_договор]--> Правительства

### Тест 2: 07_11_2023_СЗ_3264_23_Сыч_Е_А_Виленский_И_Б_ (1).pdf (малый документ)
- **Размер**: 2,304 символов
- **Сущностей найдено**: 12 (после фильтрации)
- **Связей найдено**: 6
- **Цепочек построено**: 6
- **Бизнес-процесс**: IT и цифровые процессы - Интеграция систем
- **Уверенность**: 0.20

**Примеры извлеченных сущностей:**
- Департамента информационных технологий (ORG)
- АО «ВДНХ» (ORG)
- Илья Борисович (PER)
- Е.А.Сыч (PER)

**Примеры связей:**
- Департамента информационных технологий --[связан_с]--> АО «ВДНХ»
- АО «ВДНХ» --[связан_с]--> И.Б.

## Улучшения, внесенные в процессе тестирования

### 1. Фильтрация сущностей
- Добавлена проверка на стоп-слова ("договор", "согласование", "доверенность")
- Улучшена нормализация текста (удаление лишних пробелов, переносов строк)
- Фильтрация слишком коротких сущностей

### 2. Дедупликация
- Улучшена дедупликация сущностей (нормализация перед сравнением)
- Выбор более полной версии при дубликатах

### 3. Извлечение связей
- Добавлена проверка валидности связей
- Фильтрация связей между одинаковыми сущностями
- Улучшена логика определения типа связи
- Уменьшено количество общих связей "связан_с"

### Результаты улучшений:
- **До**: 305 связей, 96 сущностей (Договор.docx)
- **После**: 190 связей, 93 сущности (Договор.docx)
- **До**: 8 связей, 14 сущностей (PDF)
- **После**: 6 связей, 12 сущностей (PDF)

## Выявленные проблемы

### 1. Качество NER
- Иногда неправильно определяется тип сущности (например, "Коммерческого директора" как ORG вместо PER)
- Это ограничение модели Natasha - можно улучшить, используя более точные модели или постобработку

### 2. Извлечение связей
- Некоторые связи слишком общие ("связан_с")
- Можно улучшить, добавив больше паттернов или используя LLM

### 3. Классификация бизнес-процессов
- Keyword-based подход работает, но confidence иногда низкий
- Можно улучшить, используя ML-модель или LLM

## Производительность

- **Скорость обработки**: ~1-3 секунды на документ (зависит от размера)
- **Использование памяти**: Низкое (все модели работают на CPU)
- **Масштабируемость**: Хорошая, можно обрабатывать батчами

## Рекомендации по дальнейшему улучшению

1. **Для улучшения NER**:
   - Использовать более точные модели (ru_core_news_lg для SpaCy)
   - Добавить постобработку с использованием правил
   - Fine-tuning на корпусе документов ВДНХ

2. **Для улучшения извлечения связей**:
   - Добавить локальный LLM (Qwen2.5-1.5B, Mistral-7B)
   - Использовать API (Claude, GPT-4) для сложных случаев
   - Обучить модель на размеченных данных

3. **Для улучшения классификации**:
   - Заменить keyword-based на ML-модель
   - Использовать zero-shot классификацию через rubert-base
   - Fine-tuning на размеченных документах

## Заключение

Пайплайн успешно работает и извлекает информацию из документов. Качество извлечения хорошее для MVP, но есть возможности для улучшения. Все компоненты функционируют корректно, результаты сохраняются в структурированном JSON формате.

**Статус**: ✅ Готов к использованию
